[
  {
    "name": "gift_population_filter",
    "sid": [ { "uid": "GIFT_afc_000042BUR201001" } ],
    "parameters": {
      "item": "FOOD_AMOUNT_PROC",
      "gender": null,
      "special_condition": ["2"],
      "age_year": {
        "from": 10.5,
        "to": 67
      }
    }
  },

  {
    "name": "filter",
    "parameters": {
      "columns": [
        "group_code",
        "subgroup_code",
        "foodex2_code",
        "value"
      ],
      "rows": {
        "!group_code": {
          "codes": [
            {
              "uid": "GIFT_FoodGroups",
              "codes": [ "14" ]
            }
          ]
        }
      }
    }
  },

  {
    "name": "group",
    "rid": { "uid": "food_level_group" },
    "parameters": {
      "by": [
        "group_code",
        "subgroup_code",
        "foodex2_code"
      ],
      "aggregations": [
        {
          "columns": [ "value" ],
          "rule": "SUM"
        }
      ]
    }
  },

  {
    "name": "group",
    "rid": { "uid": "subgroup_level_group" },
    "parameters": {
      "by": [
        "group_code",
        "subgroup_code"
      ],
      "aggregations": [
        {
          "columns": [ "value" ],
          "rule": "SUM"
        }
      ]
    }
  },

  {
    "name": "group",
    "rid": { "uid": "group_level_group" },
    "parameters": {
      "by": [
        "group_code"
      ],
      "aggregations": [
        {
          "columns": [ "value" ],
          "rule": "SUM"
        }
      ]
    }
  },

  {
    "name": "asTable"
  },

  {
    "name": "percentage"
  },

  {
    "name": "addcolumn",
    "rid": { "uid": "group_data" },
    "parameters": {
      "column": {
        "dataType": "code",
        "id": "um",
        "subject" : "um",
        "title": {
          "EN": "Unit of measure"
        },
        "domain": {
          "codes": [
            {
              "idCodeList": "GIFT_UM"
            }
          ]
        }
      },
      "value": "perc"
    }
  },




  {
    "name": "join",
    "sid": [
      { "uid": "group_level_group" },
      { "uid": "subgroup_level_group" }
    ],
    "parameters": {
      "joins": [
        [ { "type": "id", "value": "group_code" } ],
        [ { "type": "id", "value": "group_code" } ]
      ],
      "values": []
    }
  },

  {
    "name" : "select",
    "parameters" : {
      "values" : {
        "group_code" : null,
        "subgroup_level_group_subgroup_code" : null,
        "subgroup_level_group_value" : "(subgroup_level_group_value*100.0)/group_level_group_value"
      }
    }
  },

  {
    "name": "addcolumn",
    "rid": { "uid": "subgroup_data" },
    "parameters": {
      "column": {
        "dataType": "code",
        "id": "um",
        "subject" : "um",
        "title": {
          "EN": "Unit of measure"
        },
        "domain": {
          "codes": [
            {
              "idCodeList": "GIFT_UM"
            }
          ]
        }
      },
      "value": "perc"
    }
  },



  {
    "name": "join",
    "sid": [
      { "uid": "subgroup_level_group" },
      { "uid": "food_level_group" }
    ],
    "parameters": {
      "joins": [
        [ { "type": "id", "value": "subgroup_code" } ],
        [ { "type": "id", "value": "subgroup_code" } ]
      ],
      "values": []
    }
  },

  {
    "name" : "select",
    "parameters" : {
      "values" : {
        "subgroup_code" : null,
        "food_level_group_foodex2_code" : null,
        "food_level_group_value" : "(food_level_group_value*100.0)/subgroup_level_group_value"
      }
    }
  },

  {
    "name": "addcolumn",
    "rid": { "uid": "food_data" },
    "parameters": {
      "column": {
        "dataType": "code",
        "id": "um",
        "subject" : "um",
        "title": {
          "EN": "Unit of measure"
        },
        "domain": {
          "codes": [
            {
              "idCodeList": "GIFT_UM"
            }
          ]
        }
      },
      "value": "perc"
    }
  }

]